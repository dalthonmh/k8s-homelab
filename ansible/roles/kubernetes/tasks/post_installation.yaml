---
# Step 1. Configure aliases and autocompletion for kubectl
- name: Add kubectl alias to .bashrc
  lineinfile:
    path: ~/.bashrc
    line: "alias k=kubectl"
    state: present

- name: Add kubectl autocompletion for alias 'k' to .bashrc
  lineinfile:
    path: ~/.bashrc
    line: "complete -o default -F __start_kubectl k"
    state: present

- name: Add kubectl autocompletion to .bashrc
  lineinfile:
    path: ~/.bashrc
    line: "source <(kubectl completion bash)"
    state: present

- name: Reload .bashrc to apply changes
  shell: source ~/.bashrc
  args:
    executable: /bin/bash

# Step 2. Configure Vim settings
- name: Configure Vim settings in .vimrc
  copy:
    dest: ~/.vimrc
    content: |
      set ts=2
      set sts=2
      set sw=2
      set et
      set ai

# Configurar variable de entorno para dry-run de kubectl
- name: Add kubectl dry-run alias to .bashrc
  lineinfile:
    path: ~/.bashrc
    line: 'export do="--dry-run=client -o yaml"'
    state: present

- name: Reload .bashrc to apply dry-run alias
  shell: source ~/.bashrc
  args:
    executable: /bin/bash
